<!-- {"title": "Upcoming Convergence MUSH Logs", "slug": "logs/upcoming"} -->

<h2>Upcoming Convergence MUSH Scenes</h2>
<div class="logslist-wrapper">
	<div class="logslist" id="logslist">
	<div class="logs-grid-header">
		<div class="logs-grid-cell"></div>
		<div class="logs-grid-cell">ID</div>
		<div class="logs-grid-cell">Title</div>
		<div class="logs-grid-cell">Date</div>
		<div class="logs-grid-cell">Creator</div>
	</div>
		<div id="logsTableBody" class="logs-grid"></div>
	</div>
	<div class="logslist-fade logslist-fade-left"></div>
	<div class="logslist-fade logslist-fade-right"></div>
</div>


<script>
async function loadScenes() {
	
	const res = fetch("/api/logs/upcoming/", {
		method: "POST",
		headers: { "Content-Type": "application/json" },
		body: JSON.stringify({ start })
	})
	.then(r => r.json())
	.then(scenes => {
		const tbody = document.querySelector("#logsTableBody")
		tbody.innerHTML = ""

		for(const scene of scenes) {
			const sceneNumber = scene.scene_id
			const title = scene.scene_title
			const status = scene.scene_status

			const statusEmojiMap = {
				"Scheduled": "âšª",
				"Paused": "ðŸŸ ",
				"Active": "ðŸ”´",
				"Finished": "ðŸŸ¢"
			}
			
			const statusCell = document.createElement("div")
			statusCell.className = "logs-grid-cell"
			statusCell.textContent = statusEmojiMap[status] || "âš«"
			tbody.appendChild(statusCell)
			
			const idCell = document.createElement("div")
			idCell.className = "logs-grid-cell"
			idCell.innerHTML = `<a href="/logs/${sceneNumber}/">${sceneNumber}</a>`
			tbody.appendChild(idCell)
			
			const titleCell = document.createElement("div")
			titleCell.className = "logs-grid-cell"
			titleCell.innerHTML = `<a href="/logs/${sceneNumber}/">${title}</a>`
			tbody.appendChild(titleCell)
			
			const dateDisplay = scene.scene_date_started || scene.scene_date_scheduled || scene.scene_date_created || "-"
			const dateObj = new Date(dateDisplay)
			const dateStr = isNaN(dateObj.getTime()) ? dateDisplay : dateObj.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })
			
			const dateCell = document.createElement("div")
			dateCell.className = "logs-grid-cell"
			dateCell.textContent = dateStr
			tbody.appendChild(dateCell)
			
			const creatorCell = document.createElement("div")
			creatorCell.className = "logs-grid-cell"
			let creatorLink = "-"
			if (scene.creator_name) {
				let creatorDbref = scene.creator_objid
				if (creatorDbref) {
					creatorDbref = creatorDbref.split(':')[0].substring(1)
				}
				creatorLink = `<a href="/characters/${creatorDbref}/">${scene.creator_name}</a>`
			}
			creatorCell.innerHTML = creatorLink
			tbody.appendChild(creatorCell)
		}
		

	})
}



document.addEventListener("DOMContentLoaded", async () => {
	await loadScenes()
})
</script>
